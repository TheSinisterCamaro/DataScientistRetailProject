import pandas as pd

# Define the path to the already cleaned data
file_path = r'C:\Users\jdick\source\repos\DataScientistRetailProject\cleaned_online_retail_II.csv'

# Load the cleaned data
data_cleaned = pd.read_csv(file_path)

# Display the first few rows to ensure it loaded correctly
print("First 5 rows of the cleaned data:")
print(data_cleaned.head())

# Check the structure of the DataFrame
print("\nDataFrame structure:")
print(data_cleaned.info())

# Fill missing Description with 'No description'
data_cleaned['Description'].fillna('No description', inplace=True)

# Fill missing Customer ID with 0 to represent anonymous customers
data_cleaned['Customer ID'].fillna(0, inplace=True)

# Convert InvoiceDate to datetime format
data_cleaned['InvoiceDate'] = pd.to_datetime(data_cleaned['InvoiceDate'])

# Optionally, drop duplicates
data_cleaned.drop_duplicates(inplace=True)

# Check for negative quantities or prices
negative_values = data_cleaned[(data_cleaned['Quantity'] < 0) | (data_cleaned['Price'] < 0)]
print("Negative Quantity or Price rows:\n", negative_values)

# Optionally, remove rows with negative Quantity or Price
data_cleaned = data_cleaned[(data_cleaned['Quantity'] > 0) & (data_cleaned['Price'] > 0)]

# Save the fully cleaned data
final_file_path = r'C:\Users\jdick\source\repos\DataScientistRetailProject\fully_cleaned_online_retail_II.csv'
data_cleaned.to_csv(final_file_path, index=False)

print("Further cleaning completed and saved to:", final_file_path)
